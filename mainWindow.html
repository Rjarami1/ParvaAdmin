<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SGP - Ingreso de Usuario</title>
</head>
<body>
    <h3>Bienvenido al Sistema de Gestion de Panadería</h3>

    <form id="form1">
        <p>Ingrese su usuario y contraseña:</p>
        <br>
        <p>Usuario:</p>
        <input type="text" id="user">
        
        <p>Contraseña:</p>
        <input type="password" id="password">

        <button type="submit" value="Ingresar">Ingresar</button>
        <br>
        <br>
        <img src="./load.gif" alt="loading..." style="visibility: hidden; height: 50px; width: 50px;">
        <p style="color: red;" id="loginError"></p>
    </form>
    
    <script>
    const {ipcRenderer} = require('electron');
    const errormsg = document.querySelector('#loginError');
    
    document.querySelector('form').addEventListener('submit', (e) => {
        e.preventDefault();
        document.querySelector('img').style.visibility = 'visible';
        document.querySelector('button').disabled = true;

        const userLogin = document.querySelector('#user').value;
        const passLogin = document.querySelector('#password').value;
        
        if(userLogin == '' || passLogin == ''){
            document.querySelector('img').style.visibility = 'hidden';
            document.querySelector('button').disabled = false;
            errormsg.textContent = 'Por favor ingresar todos los campos';
        }
        else
        {
            ipcRenderer.send('login:in', [userLogin, passLogin]);
            errormsg.textContent = '';
        }
        
    })

    ipcRenderer.on('login:info', (e, val) => {
        if(val == 1){
            document.querySelector('img').style.visibility = 'hidden';
            document.querySelector('button').disabled = false;
            errormsg.textContent = 'Usuario o contraseña no válidos'
        }
        else{
            errormsg.textContent = '';
        }
    })

    </script>

</body>
</html>