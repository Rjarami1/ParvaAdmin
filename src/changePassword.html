<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Bootstrap 4 CSS -->
		<link
			rel="stylesheet"
			href="../dependencies/bootstrap-4.4.1-dist/css/bootstrap.min.css"
		/>
		<link rel="stylesheet" href="styles/stilosDaniel.css" />

		<meta charset="UTF-8" />
		<title>Cambiar Constraseña</title>
	</head>
	<body>
		<h2>Cambiar Constraseña:</h2>
		<form>
			<label for="current_pass">Contraseña Actual:</label><br />
			<input type="password" name="current_pass" id="current_pass" /><br />

			<label for="new_pass">Contraseña Nueva:</label><br />
			<input type="password" name="new_pass" id="new_pass" /><br />

			<label for="confirm_pass">Confirmar Contraseña:</label><br />
			<input type="password" name="confirm_pass" id="confirm_pass" /><br />

			<p id="msg" style="color: red;"></p>

			<button type="submit">Guardar</button>
		</form>

		<script>
			const { ipcRenderer } = require('electron')

			const current_pass = document.querySelector('#current_pass')
			const new_pass = document.querySelector('#new_pass')
			const confirm_pass = document.querySelector('#confirm_pass')
			const msg = document.querySelector('#msg')

			const form = document.querySelector('form')

			form.addEventListener('submit', e => {
				e.preventDefault()

				if (
					current_pass.value == '' ||
					new_pass.value == '' ||
					confirm_pass.value == ''
				) {
					msg.textContent = 'No puede dejar campos en blanco.'
				} else {
					if (new_pass.value != confirm_pass.value) {
						msg.textContent = 'Las contraseñas no coinciden.'
					} else {
						msg.textContent = ''
						ipcRenderer.send('change:pass', [
							current_pass.value,
							new_pass.value
						])
					}
				}
			})

			ipcRenderer.on('change:done', (e, status) => {
				if (status) {
					msg.style.color = 'green'
					msg.textContent = 'Contraseña cambiada con éxito'
				} else {
					msg.textContent = 'Contraseña actual no válida.'
				}
			})
		</script>

		<!-- jQuery library -->
		<script src="../dependencies/bootstrap-4.4.1-dist/js/jQuery.js"></script>
	</body>
</html>
